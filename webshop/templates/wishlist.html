<!DOCTYPE html>
<html lang="hr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wishlist</title>
    <link rel="stylesheet" href="static/styles.css">
</head>
<body>
    <header>
        <h1>Vaša Wishlist</h1>
        <button class="back-button" onclick="location.href='/'">Natrag na početnu</button>
    </header>

    <main>
        {% if proizvodi_u_wishlistu %}
        <div class="wishlist-container">
            {% for grupa, proizvodi in proizvodi_u_wishlistu.items() %}
            <div class="wishlist-group">
                <h2>{{ grupa }}</h2>
                {% for proizvod in proizvodi %}
                <div class="wishlist-item" id="wishlist-item-{{ proizvod[0] }}">
                    <h3>{{ proizvod[1] }}</h3>
                    <p>Cijena: {{ proizvod[2] }} HRK</p>
                    <button class="remove-button" onclick="ukloniIzWishliste({{ proizvod[0] }})">Ukloni iz wishliste</button>
                </div>
                {% endfor %}
            </div>
            {% endfor %}
        </div>
        {% else %}
        <p class="empty-message">Nemate proizvode u wishlisti.</p>
        {% endif %}
    </main>

<script>
    function ukloniIzWishliste(proizvodId) {
        fetch('/wishlist/ukloni', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ proizvod_id: proizvodId })
        })
        .then(response => response.json())
        .then(data => {
            if (data.message) {
                alert(data.message); // Prikaz poruke korisniku (opcionalno)
                // Ukloni proizvod iz prikaza
                const item = document.getElementById(`wishlist-item-${proizvodId}`);
                if (item) {
                    item.remove();
                }
            }
        })
        .catch(error => {
            console.error('Greška:', error);
            alert('Došlo je do greške pri uklanjanju proizvoda.');
        });
    }
</script>

</body>
</html>
